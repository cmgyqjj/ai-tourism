<!--è¡Œç¨‹PKé¡µé¢-->
<view class="strategy-pk-container">
  <!-- å¯¼èˆªæ  -->
  <view class="nav-bar">
    <view class="nav-left" bindtap="goBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="nav-title">è¡Œç¨‹PK</view>
    <view class="nav-right" bindtap="closePage">
      <text class="close-icon">Ã—</text>
    </view>
  </view>

  <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
  <view class="tab-nav">
    <view class="tab-item {{currentTab === 0 ? 'active' : ''}}" bindtap="switchTab" data-index="0">
      <text>åŸºæœ¬ä¿¡æ¯</text>
      <view class="tab-underline" wx:if="{{currentTab === 0}}"></view>
    </view>
    <view class="tab-item {{currentTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-index="1">
      <text>å·®å¼‚ç‚¹</text>
      <view class="tab-underline" wx:if="{{currentTab === 1}}"></view>
    </view>
    <view class="tab-item {{currentTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-index="2">
      <text>AIèåˆ</text>
      <view class="tab-underline" wx:if="{{currentTab === 2}}"></view>
    </view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <scroll-view class="content-area" scroll-y="true">
    <!-- åŸºæœ¬ä¿¡æ¯é¡µé¢ -->
    <view wx:if="{{currentTab === 0}}" class="basic-info-content">
      
      <!-- å·²æœ‰æ–¹æ¡ˆ -->
      <view class="section existing-plans">
        <view class="header-container">
            <view class="section-title">å·²æœ‰æ–¹æ¡ˆ</view>
            <scroll-view class="plans-container" scroll-x="true" show-scrollbar="false" enhanced="true">
                <view class="plans-wrapper {{layoutClass}}">
                <view class="plan-card" wx:for="{{existingPlans}}" wx:key="id">
                    <view class="plan-status">
                    <view class="status-badge {{item.voted ? 'voted' : 'not-voted'}}">
                        <text class="check-icon">âœ“</text>
                        <text>{{item.voted ? 'å·²æŠ•ç¥¨' : 'æœªæŠ•ç¥¨'}}</text>
                    </view>
                    </view>
                    <view class="plan-content">
                    <view class="title-row">
                        <view class="plan-icon">
                        <text class="icon-text">{{item.iconText}}</text>
                        </view>
                        <view class="plan-title">{{item.title}}</view>
                    </view>
                    <view class="plan-subtitle">{{item.subtitle}}</view>
                    <view class="vote-section">
                        <view class="avatar-badge">
                        <image class="avatar-img" src="{{item.avatar}}" mode="aspectFill"></image>
                        </view>
                        <view class="vote-btn {{item.voted ? 'voted' : ''}}" bindtap="toggleVote" data-id="{{item.id}}">
                        <text class="vote-icon">{{item.voted ? 'âœ“' : 'ğŸ‘'}}</text>
                        <text>{{item.voted ? 'å·²æŠ•ç¥¨' : 'ç‚¹æ­¤æŠ•ç¥¨'}}</text>
                        </view>
                    </view>
                    </view>
                </view>
                </view>
            </scroll-view>
            </view>
      </view>

      <!-- æ–¹æ¡ˆäº®ç‚¹ -->
      <view class="section plan-highlights">
  <view class="header-container">
    <view class="section-title">æ–¹æ¡ˆäº®ç‚¹</view>
    <scroll-view class="highlights-container" scroll-x="true" show-scrollbar="false" enhanced="true">
      <view class="highlights-wrapper">
        <view class="highlight-card" wx:for="{{planHighlights}}" wx:key="id">
          <view class="highlight-content">{{item.content}}</view>
          <view class="highlight-tags">
            <view class="tag" wx:for="{{item.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>


      <!-- é¢„ç®—ä»·æ ¼ -->
      <view class="section budget-section">
  <view class="section-header" bindtap="toggleBudget">
    <text class="section-title">é¢„ç®—ä»·æ ¼</text>
    <view class="arrow-icon {{budgetExpanded ? 'expanded' : ''}}">â–¼</view>
  </view>
  
  <!-- æ§åˆ¶å±•å¼€å’Œæ”¶èµ· -->
  <view class="budget-content {{budgetExpanded ? 'expanded' : 'collapsed'}}">
    <scroll-view class="budget-container" scroll-x="true" show-scrollbar="flase" enhanced="true" >
      <view class="budget-wrapper">
        <!-- éå† budgetItems -->
        <view class="budget-row" wx:for="{{budgetItems}}" wx:key="label">
          <view class="budget-label">{{item.label}}</view>
          <view class="budget-values">
            <!-- éå†æ¯ä¸ªé¢„ç®—é¡¹çš„å€¼ -->
            <view class="budget-value" wx:for="{{item.values}}" wx:key="*this" wx:for-item="value">{{value}}</view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>



      <!-- ç‹¬å®¶ä½“éªŒ -->
      <view class="section exclusive-experience">
        <view class="section-header" bindtap="toggleExclusive">
          <text class="section-title">ç‹¬å®¶ä½“éªŒ</text>
          <view class="arrow-icon {{exclusiveExpanded ? 'expanded' : ''}}">â–¼</view>
        </view>
        <view class="exclusive-content {{exclusiveExpanded ? 'expanded' : 'collapsed'}}" style="{{exclusiveExpanded ? 'display:block' : 'display:none'}}">
          <scroll-view class="exclusive-container" scroll-x="true" show-scrollbar="false" enhanced="true" style="height: 400rpx;">
            <view class="exclusive-wrapper">
              <view class="exclusive-row" wx:for="{{exclusiveItems}}" wx:key="label">
                <view class="exclusive-label">{{item.label}}</view>
                <view class="exclusive-values">
                  <view class="exclusive-value" wx:for="{{item.values}}" wx:key="*this" wx:for-item="value">{{value}}</view>
                </view>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>

      <!-- ä½å®¿ä½ç½® -->
      <view class="section accommodation">
        <view class="section-header" bindtap="toggleAccommodation">
          <text class="section-title">ä½å®¿ä½ç½®</text>
          <view class="arrow-icon {{accommodationExpanded ? 'expanded' : ''}}">â–¼</view>
        </view>
        <view class="accommodation-content {{accommodationExpanded ? 'expanded' : 'collapsed'}}" style="{{accommodationExpanded ? 'display:block' : 'display:none'}}">
          <scroll-view class="accommodation-container" scroll-x="true" show-scrollbar="false" enhanced="true">
            <view class="accommodation-wrapper">
              <view class="accommodation-row" wx:for="{{accommodationItems}}" wx:key="label">
                <view class="accommodation-label">{{item.label}}</view>
                <view class="accommodation-values">
                  <view class="accommodation-value" wx:for="{{item.values}}" wx:key="*this" wx:for-item="value">{{value}}</view>
                </view>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>

      <!-- äº¤é€šæ–¹å¼ -->
      <view class="section transportation">
        <view class="section-header" bindtap="toggleTransportation">
          <text class="section-title">äº¤é€šæ–¹å¼</text>
          <view class="arrow-icon {{transportationExpanded ? 'expanded' : ''}}">â–¼</view>
        </view>
        <view class="transportation-content {{transportationExpanded ? 'expanded' : 'collapsed'}}" style="{{transportationExpanded ? 'display:block' : 'display:none'}}">
          <scroll-view class="transportation-container" scroll-x="true" show-scrollbar="false" enhanced="true">
            <view class="transportation-wrapper">
              <view class="transportation-row" wx:for="{{transportationItems}}" wx:key="label">
                <view class="transportation-label">{{item.label}}</view>
                <view class="transportation-values">
                  <view class="transportation-value" wx:for="{{item.values}}" wx:key="*this" wx:for-item="value">{{value}}</view>
                </view>
              </view>
            </view>
          </scroll-view>
        </view>
      </view>

    </view>

    <!-- å·®å¼‚ç‚¹é¡µé¢ -->
    <view wx:elif="{{currentTab === 1}}" class="difference-content">
      <!-- å·²æœ‰æ–¹æ¡ˆ -->
      <view class="section existing-plans">
        <view class="header-container">
        <view class="section-title">å·²æœ‰æ–¹æ¡ˆ</view>
        <scroll-view class="plans-container" scroll-x="true" show-scrollbar="false" enhanced="true">
          <view class="plans-wrapper {{layoutClass}}">
            <view class="plan-card" wx:for="{{existingPlans}}" wx:key="id">
              <view class="plan-status">
                <view class="status-badge {{item.voted ? 'voted' : 'not-voted'}}">
                  <text class="check-icon">âœ“</text>
                  <text>{{item.voted ? 'å·²æŠ•ç¥¨' : 'æœªæŠ•ç¥¨'}}</text>
                </view>
              </view>
              <view class="plan-content">
                <view class="title-row">
                  <view class="plan-icon">
                    <text class="icon-text">{{item.iconText}}</text>
                  </view>
                  <view class="plan-title">{{item.title}}</view>
                </view>
                <view class="plan-subtitle">{{item.subtitle}}</view>
                <view class="vote-section">
                  <view class="avatar-badge">
                    <image class="avatar-img" src="{{item.avatar}}" mode="aspectFill"></image>
                  </view>
                  <view class="vote-btn {{item.voted ? 'voted' : ''}}" bindtap="toggleVote" data-id="{{item.id}}">
                    <text class="vote-icon">{{item.voted ? 'âœ“' : 'ğŸ‘'}}</text>
                    <text>{{item.voted ? 'å·²æŠ•ç¥¨' : 'ç‚¹æ­¤æŠ•ç¥¨'}}</text>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </scroll-view>
        </view>
      </view>

      <!-- æ ¸å¿ƒå·®å¼‚ -->
      <view class="section core-differences">
  <view class="section-header" bindtap="toggleCoreDifferences">
    <text class="section-title">æ ¸å¿ƒå·®å¼‚</text>
    <view class="arrow-icon {{coreDifferencesExpanded ? 'expanded' : ''}}">â–¼</view>
  </view>
  <view class="differences-content {{coreDifferencesExpanded ? 'expanded' : 'collapsed'}}">
    <view class="differences-table">
      <view class="differences-row" wx:for="{{coreDifferences}}" wx:key="label">
        <view class="diff-label">{{item.label}}</view>
        <view class="diff-values">
          <view class="diff-value" wx:for="{{item.values}}" wx:key="{{index}}">
            {{item.values[index]}}
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
</view>



    <!-- AIèåˆé¡µé¢ -->
    <view wx:elif="{{currentTab === 2}}" class="ai-fusion-content">
      <view class="fusion-plans-grid {{layoutClass}}">
        <view class="fusion-plan-card" wx:for="{{existingPlans}}" wx:key="id">
          <view class="plan-status">
            <view class="status-badge {{item.voted ? 'voted' : 'not-voted'}}">
              <text class="check-icon">âœ“</text>
              <text>{{item.voted ? 'å·²æŠ•ç¥¨' : 'æœªæŠ•ç¥¨'}}</text>
            </view>
          </view>
          <view class="plan-content">
            <view class="title-row">
              <view class="plan-icon">
                <text class="icon-text">{{item.iconText}}</text>
              </view>
              <view class="plan-title">{{item.title}}</view>
            </view>
            <view class="plan-subtitle">{{item.subtitle}}</view>
            <view class="vote-section">
              <view class="avatar-badge">
                <image class="avatar-img" src="{{item.avatar}}" mode="aspectFill"></image>
              </view>
              <view class="vote-btn {{item.voted ? 'voted' : ''}}" bindtap="toggleVote" data-id="{{item.id}}">
                <text class="vote-icon">{{item.voted ? 'âœ“' : 'ğŸ‘'}}</text>
                <text>{{item.voted ? 'å·²æŠ•ç¥¨' : 'ç‚¹æ­¤æŠ•ç¥¨'}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="bottom-actions" wx:if="{{currentTab !== 2}}">
    <view class="action-btn secondary" bindtap="downloadReport">
      <text>ä¸‹è½½å¯¹æ¯”æŠ¥å‘Š</text>
    </view>
    <view class="action-btn primary" bindtap="shareItinerary">
      <text class="share-icon">â¤´</text>
      <text>åˆ†äº«å¯¹æ¯”è¡Œç¨‹</text>
    </view>
  </view>

  <!-- AIèåˆæŒ‰é’® -->
  <view class="ai-fusion-actions" wx:if="{{currentTab === 2}}">
    <!-- å‘¼å”¤é˜Ÿé•¿è§£é”è¯­éŸ³æ°”æ³¡ -->
    <image class="captain-call-bubble" src="/images/strategyPK/a.png" mode="aspectFill"></image>
    
    <view class="ai-fusion-btn" bindtap="generateFusionPlan">
      <image class="ai-fusion-bg" src="/images/strategyPK/btn.png" mode="aspectFill"></image>
      <view class="ai-fusion-content">
      
      </view>
    </view>
  </view>
</view>
