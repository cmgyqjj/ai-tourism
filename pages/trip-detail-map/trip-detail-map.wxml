<view class="trip-detail-container">
  <!-- é¡¶éƒ¨é€€å‡ºæŒ‰é’® -->
  <view class="back-btn" bindtap="goBack">
    <text class="back-arrow">â€¹</text>
  </view>

  <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
  <view class="main-content">
    <!-- åœ°å›¾åŒºåŸŸ - å å±å¹•1/3 -->
    <view class="map-section">
      <map 
        id="tripMap"
        class="trip-map"
        longitude="{{mapCenter.longitude}}"
        latitude="{{mapCenter.latitude}}"
        scale="{{mapScale}}"
        markers="{{mapMarkers}}"
        polyline="{{mapPolyline}}"
        show-location="true"
        bindmarkertap="onMarkerTap"
        bindregionchange="onRegionChange"
        bindload="onMapLoad">
      </map>
    </view>
  <view class="trip-content-container">
    <!-- è¡Œç¨‹æ ‡é¢˜åŒºåŸŸ - ç§»åŠ¨åˆ°åœ°å›¾ä¸‹é¢ -->
    <view class="trip-header">
      <view class="trip-title">
        <text class="title-text">æˆ‘çš„ï¼š{{tripTitle}}</text>
        <view class="trip-duration" bindtap="viewTripDetails">
          <text class="duration-text">{{tripDuration}}</text>
          <text class="arrow">></text>
        </view>
      </view>
      <view class="participants">
        <view class="participant-avatar" wx:for="{{participants}}" wx:key="index">
          <image class="avatar" src="{{item.avatar}}" mode="aspectFill"></image>
          <view class="checkmark" wx:if="{{item.isCurrentUser}}">âœ“</view>
        </view>
        <view class="more-participants" wx:if="{{participants.length > 3}}">
          <text class="more-text">+{{participants.length - 3}}</text>
        </view>
      </view>
    </view>

    <!-- è¡Œç¨‹å†…å®¹åŒºåŸŸ - å å±å¹•2/3 -->
    <view class="trip-content">
               <!-- å·¦ä¾§æ—¥æœŸåˆ—è¡¨ -->
         <view class="date-list">
           <scroll-view class="date-scroll" scroll-y="true">
             <view class="date-item {{selectedDay === item.day ? 'active' : ''}}" 
                   wx:for="{{tripDays}}" 
                   wx:key="day"
                   bindtap="selectDay"
                   data-day="{{item.day}}">
               <!-- é¡¶éƒ¨è¡Œï¼šæ—¥å†å›¾æ ‡ + æ—¥æœŸæ•°å­— + å¤©æ°”å›¾æ ‡ -->
               <view class="date-top-row">
                 <image class="calendar-icon" src="/images/calendar.png" mode="aspectFit"></image>
                 <text class="day-number">{{item.day}}</text>
                 <text class="weather-icon">{{item.weather}}</text>
               </view>
               <!-- ä¸­é—´è¡Œï¼šæ—¥æœŸæ–‡æœ¬ -->
               <view class="date-middle-row">
                 <text class="date-text">{{item.date}}</text>
               </view>
               <!-- åº•éƒ¨è¡Œï¼šè·¯çº¿æ–‡æœ¬ -->
               <view class="date-bottom-row">
                 <text class="route-text">{{item.route}}</text>
               </view>
             </view>
           </scroll-view>
         </view>

             <!-- å³ä¾§è¡Œç¨‹è¯¦æƒ… -->
       <scroll-view class="trip-details" scroll-y="true">
         <!-- è¡Œç¨‹ä¿¡æ¯å®¹å™¨ -->
         <view class="trip-info-container">
           <view class="day-header">
             <text class="day-title">ç¬¬{{selectedDay}}å¤© | {{currentDayInfo.route}}</text>
           </view>

           <!-- èˆªç­ä¿¡æ¯ -->
           <view class="detail-section" wx:if="{{currentDayInfo.flight}}">
             <view class="section-header">
               <text class="section-title">èˆªç­ä¿¡æ¯</text>
               <view class="section-content">
               <text class="flight-info">{{currentDayInfo.flight}}</text>
             </view>
             </view>
           
           </view>

           <!-- ä½å®¿å»ºè®® -->
           <view class="detail-section">
             <view class="section-header">
               <text class="section-title">ä½å®¿å»ºè®®</text>
               <view class="section-content">
               <text class="accommodation-info">{{currentDayInfo.accommodation}}</text>
            
             </view>

             </view>
          
           </view>
         </view>
 <!-- ç¾é£Ÿæ¨è -->
 <view class="detail-section" wx:for="{{currentDayInfo.food}}" wx:key="index">
   <view class="item-card">
     <!-- ä¸ŠåŠéƒ¨åˆ†ï¼šä¸»å†…å®¹åŒº -->
     <view class="item-main-content">
       <!-- å·¦ä¾§å›¾ç‰‡ -->
       <view class="item-image-container">
         <image class="item-image" src="{{item.image}}" mode="aspectFill"></image>
       </view>

       <!-- ä¸­é—´æ–‡æœ¬ä¿¡æ¯ -->
       <view class="item-info">
         <!-- é¡¶éƒ¨ï¼šåˆ†ç±»æ ‡é¢˜ -->
         <view class="category-header">
           <view class="category-icon food-icon">ğŸ½ï¸</view>
           <text class="category-label">ç¾é£Ÿ</text>
         </view>
         <!-- ä¸­é—´ï¼šåº—å -->
         <text class="item-name">{{item.name}}</text>
         <!-- åº•éƒ¨ï¼šä»·æ ¼ä¿¡æ¯ -->
         <text class="item-price">äººå‡: Â¥{{item.price}}</text>
       </view>

       <!-- å³ä¸Šè§’èœå•æŒ‰é’® -->
       <view class="item-menu" bindtap="showItemMenu" data-index="{{index}}">
         <text class="menu-icon">â˜°</text>
       </view>
     </view>

     <!-- ä¸‹åŠéƒ¨åˆ†ï¼šåº•éƒ¨ä¿¡æ¯åŒº -->
     <view class="item-bottom-info" bindtap="navigateToLocation" data-location="{{item.location}}">
       <image class="car-icon" src="/images/car.png" mode="aspectFit"></image>
       <text class="distance-text">{{item.distance}}å…¬é‡ŒÂ·{{item.time}}åˆ†é’Ÿ<text class="navigate-arrow">></text></text>
     </view>
   </view>
 </view>

                                                                                                                                               <!-- æ™¯ç‚¹æ¨è -->
            <view class="detail-section" wx:for="{{currentDayInfo.attractions}}" wx:key="index">
              <view class="item-card">
                <!-- ä¸ŠåŠéƒ¨åˆ†ï¼šä¸»å†…å®¹åŒº -->
                <view class="item-main-content">
                  <!-- å·¦ä¾§å›¾ç‰‡ -->
                  <view class="item-image-container">
                    <image class="item-image" src="{{item.image}}" mode="aspectFill"></image>
                  </view>

                  <!-- ä¸­é—´æ–‡æœ¬ä¿¡æ¯ -->
                  <view class="item-info">
                    <!-- é¡¶éƒ¨ï¼šåˆ†ç±»æ ‡é¢˜ -->
                    <view class="category-header">
                      <view class="category-icon attraction-icon">ğŸ”ï¸</view>
                      <text class="category-label">æ™¯ç‚¹</text>
                    </view>
                    <!-- ä¸­é—´ï¼šæ™¯ç‚¹åç§° -->
                    <text class="item-number">{{index + 1}}.{{item.name}}</text>
                    <!-- åº•éƒ¨ï¼šæ™¯ç‚¹æè¿° -->
                    <text class="item-desc">{{item.description}}</text>
                  </view>

                  <!-- å³ä¸Šè§’èœå•æŒ‰é’® -->
                  <view class="item-menu" bindtap="showItemMenu" data-index="{{index}}">
                    <text class="menu-icon">â˜°</text>
                  </view>
                </view>

                <!-- ä¸‹åŠéƒ¨åˆ†ï¼šåº•éƒ¨ä¿¡æ¯åŒº -->
                <view class="item-bottom-info" bindtap="navigateToLocation" data-location="{{item.location}}">
                  <image class="car-icon" src="/images/car.png" mode="aspectFit"></image>
                  <text class="distance-text">{{item.distance}}å…¬é‡ŒÂ·{{item.time}}åˆ†é’Ÿ<text class="navigate-arrow">></text></text>
                </view>
              </view>
            </view>

                                                                                                                                               <!-- ä½å®¿æ¨è -->
            <view class="detail-section" wx:for="{{currentDayInfo.hotels}}" wx:key="index">
              <view class="item-card">
                <!-- ä¸ŠåŠéƒ¨åˆ†ï¼šä¸»å†…å®¹åŒº -->
                <view class="item-main-content">
                  <!-- å·¦ä¾§å›¾ç‰‡ -->
                  <view class="item-image-container">
                    <image class="item-image" src="{{item.image}}" mode="aspectFill"></image>
                  </view>

                  <!-- ä¸­é—´æ–‡æœ¬ä¿¡æ¯ -->
                  <view class="item-info">
                    <!-- é¡¶éƒ¨ï¼šåˆ†ç±»æ ‡é¢˜ -->
                    <view class="category-header">
                      <view class="category-icon hotel-icon">ğŸ›ï¸</view>
                      <text class="category-label">ä½å®¿æ¨è</text>
                    </view>
                    <!-- ä¸­é—´ï¼šé…’åº—åç§° -->
                    <text class="item-name">{{item.name}}</text>
                    <!-- åº•éƒ¨ï¼šä»·æ ¼ä¿¡æ¯ -->
                    <text class="item-price">{{item.nights}}æ™š:Â¥{{item.price}}</text>
                  </view>

                  <!-- å³ä¸Šè§’èœå•æŒ‰é’® -->
                  <view class="item-menu" bindtap="showItemMenu" data-index="{{index}}">
                    <text class="menu-icon">â˜°</text>
                  </view>
                </view>

                <!-- ä¸‹åŠéƒ¨åˆ†ï¼šåº•éƒ¨ä¿¡æ¯åŒº -->
                <view class="item-bottom-info" bindtap="navigateToLocation" data-location="{{item.location}}">
                  <image class="car-icon" src="/images/car.png" mode="aspectFit"></image>
                  <text class="distance-text">{{item.distance}}å…¬é‡ŒÂ·{{item.time}}åˆ†é’Ÿ<text class="navigate-arrow">></text></text>
                </view>
              </view>
            </view>
      </scroll-view>
    </view>
  </view>
  </view>

  <!-- åˆ†äº«ç¡®è®¤å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showShareModal}}" bindtap="hideShareModal">
    <view class="share-modal-content" catchtap="stopPropagation">
      <view class="share-modal-header">
        <text class="share-modal-title">åˆ†äº«æ”»ç•¥</text>
        <view class="close-btn" bindtap="hideShareModal">Ã—</view>
      </view>
      
      <!-- åˆ†äº«å†…å®¹é¢„è§ˆ -->
      <view class="share-preview">
        <view class="preview-card">
          <view class="preview-header">
            <image class="preview-avatar" src="/images/avatar1.png" mode="aspectFill" />
            <view class="preview-info">
              <text class="preview-name">æˆ‘çš„</text>
              <text class="preview-type">æ—…è¡Œæ”»ç•¥</text>
            </view>
          </view>
          
          <view class="preview-content">
            <view class="preview-title">{{tripTitle}}</view>
            <view class="preview-desc">è¯¦ç»†è¡Œç¨‹æ”»ç•¥ï¼ŒåŒ…å«åœ°å›¾è·¯çº¿å’Œæ™¯ç‚¹æ¨è</view>
            <view class="preview-meta">
              <text class="preview-duration">è¡Œç¨‹æ—¶é•¿: {{tripDuration}}</text>
              <text class="preview-days">å…±{{tripDays.length}}ä¸ªè¡Œç¨‹å®‰æ’</text>
            </view>
            <view class="preview-tags">
              <text class="preview-tag">åœ°å›¾è·¯çº¿</text>
              <text class="preview-tag">æ™¯ç‚¹æ¨è</text>
              <text class="preview-tag">ç¾é£Ÿæ”»ç•¥</text>
              <text class="preview-tag">ä½å®¿å»ºè®®</text>
            </view>
          </view>
          
          <view class="preview-footer">
            <text class="preview-app">æ¥è‡ªç¾å›¢æ—…è¡Œ</text>
          </view>
        </view>
      </view>
      
      <!-- åˆ†äº«é€‰é¡¹ -->
      <view class="share-options">
        <view class="share-option">
          <button open-type="share" class="share-btn wechat">
            <view class="share-icon-wrapper">
              <image class="share-option-icon" src="/images/wx.png" mode="aspectFit" />
            </view>
            <text class="share-option-text">å¾®ä¿¡</text>
          </button>
        </view>
        
        <view class="share-option" bindtap="copyLink">
          <view class="share-icon-wrapper">
            <image class="share-option-icon" src="/images/lianjie.png" mode="aspectFit" />
          </view>
          <text class="share-option-text">å¤åˆ¶é“¾æ¥</text>
        </view>
      </view>
      
      <view class="share-modal-footer">
        <button class="cancel-share-btn" bindtap="hideShareModal">å–æ¶ˆ</button>
      </view>
    </view>
  </view>

 <!-- ä¾§è¾¹æ  -->
  <view class="sidebar {{sidebarOpen ? 'open' : ''}}">
    <!-- å¤–æ¡†å›¾ç‰‡ -->
    <!-- <image class="sidebar-frame" src="/images/travel-guide/sidebar.png" mode="aspectFit"></image>
     -->
    <!-- å†…å±‚èƒŒæ™¯å›¾ç‰‡ -->
    <image class="sidebar-bg" src="/images/travel-guide/sidebar1.png" mode="aspectFit"></image>
    
    <!-- å››ä¸ªåŠŸèƒ½æŒ‰é’®ï¼Œè¦†ç›–åœ¨å›¾ç‰‡ä¸Šå¯¹åº”çš„åŠŸèƒ½åŒºåŸŸ -->
    <view class="sidebar-btn route-optimization" bindtap="onRouteOptimization"></view>
    <view class="sidebar-btn strategy-pk" bindtap="onStrategyPK"></view>
    <view class="sidebar-btn team-strategy" bindtap="onTeamStrategy"></view>
    <view class="sidebar-btn share-friends" bindtap="onShareFriends"></view>
  </view>

  <!-- åŠ å·æŒ‰é’® -->
  <view class="add-button" bindtap="toggleSidebar">
    <text class="add-icon">+</text>
  </view>

  <!-- ä¾§è¾¹æ é®ç½© -->
  <view class="sidebar-overlay {{sidebarOpen ? 'show' : ''}}" bindtap="toggleSidebar"></view>
</view> 